# 1. Введение
## 1.1. Из линейной алгебры
#### Скалярное произведение
***Эрмитово-сопряженная матрица*** - матрица, полученная из исходной транспонированием и заменой каждого элемента на комплексно сопряженный:
$$A^\dagger = \overline{A^T}$$
***Гильбертово пространство*** - полное линейное пространство, в котором задано скалярное произведение. В пространстве квадратных матриц скалярное произведение Гильберта-Шмидта задается как:
$$(A, B) = tr(A^\dagger B)$$
#### Свойства следа:
1. $Tr(AB) = Tr(BA)$
2. $Tr(A\otimes B) = Tr(B\otimes A)$
3. $[Tr(AB)]^{*} = Tr(B^\dagger A^\dagger)$
#### Эрмитова матрица 
***Эрмитова матрица*** - матрица, совпадающая со свомим эрмитовым сопряжением:
$$H^\dagger = H$$
Свойства эрмитовой матрицы:
1. Вещественная эрмитова матрица является симметричной
2. Все собственные значения вещественны, а из собственных векторов можно составить ортонормированную систему
3. Сумма двух эрмитовых матриц - эрмитова
#### Унитарная матрица
Унитарная матрица - матрица, обратная к которой равна ее эрмитову сопряжению:
$$U^{-1} = U^\dagger$$
Свойства унитарной матрицы:
1. $U^\dagger U = U U^\dagger = I$
2. Столбцы матрицы A образуют ортонормированный базис в унитарном пространстве
3. Строки матрицы A образуют ортонормированный базис в унитарном пространстве
4. Сохраняет норму вектора: $||U\psi|| = ||\psi||$
#### Положительная определенность
Положительно (неотрицательно) определенной матрицей называют **эрмитову** матрицу, если все ее собственные значения положительны (неотрицательны).
$$\lambda_i(A) \ge 0$$
## 1.2 Матрицы Паули
***Матрицы Паули*** - набор из трёх **эрмитовых** и одновременно **унитарных** матриц $2\times2$ , составляющих базис в пространстве всех эрмитовых матриц с нулевым следом:
$$
X =
\begin{bmatrix}
0 & 1 \\ 1 & 0
\end{bmatrix}, \space\space
Y =
\begin{bmatrix}
0 & -i \\ i & 0
\end{bmatrix},\space\space
Z =
\begin{bmatrix}
1 & 0 \\ 0 & -1
\end{bmatrix}
$$
Свойства матриц Паули:
1. $\sigma_i^\dagger = \sigma_i = \sigma^{-1}$
2. $Tr(\sigma_i) = 0$
3. $Tr(\sigma_i \sigma_j) = 2\delta_{ij}$ 
4. $||\sigma_i|| = 2$
Собственные значения и собственные векторы матриц Паули:
##### Pauli-X:
$$
\lambda = 1:\space \ket{+} = \frac{1}{\sqrt{2}}(\ket{0} + \ket{1}
$$$$
\lambda = -1:\space \ket{-} = \frac{1}{\sqrt{2}}(\ket{0} - \ket{1}
$$
##### Pauli-Y:
$$
\lambda = 1:\space \ket{+i} = \frac{1}{\sqrt{2}}(\ket{0} + i\ket{1}
$$$$
\lambda = -1:\space \ket{-i} = \frac{1}{\sqrt{2}}(\ket{0} - i\ket{1}
$$
##### Pauli-Z:
$$
\lambda = 1:\space \ket{0}
$$$$
\lambda = -1:\space \ket{1}
$$
#### Разложение в базис
Для любой эрмитовой матрицы $2 \times 2$ c единичным следом существует единственное разложение вида:
$$
\rho = \frac{1}{2}(I + \alpha_1X + \alpha_2Y + \alpha_3 Z) 
$$
где $\alpha_i \in R$.
## 1.3. Матрица плотности
***Матрица плотности*** - (эрмитова) неотрицательно определенная матрица с единичным следом:
1. $\rho \ge 0$
2. $tr(\rho) =1$
Матрица плотности используется, чтобы описывать состояние квантовой системы.
#### Физический смысл
Предположим, что квантовая система находится в одном из состояний набора $\ket{\psi_i}$, причем вероятность нахождения в состоянии $\ket{\psi_i}$ равна $p_i$ . Тогда система описывается матрицей плотности:
$$\rho = \sum_i{ p_i \ket{\psi_i} \bra{\psi_i}}$$
Будем называть $\ket{\psi_i}$ чистыми состояниями (***pure state***), а состояние, описанное выше - смешанным (***mixed state***).
##### Чистота состояния
Матрица плотности чистого состояния $\ket{\psi}$ выглядит как $\rho = \ket{\psi}\bra{\psi}$. Для такого состояния на диагонали матрицы плотности будут записаны квадраты амплитуд состояния - вероятности базисных состояний:
$$
\rho = \ket{\psi}\bra{\psi} = \begin{bmatrix}\alpha\\\beta\end{bmatrix} \begin{bmatrix}\alpha^*&\beta^*\end{bmatrix} = 
\begin{bmatrix}
|\alpha|^2& \alpha \beta^*\\
\alpha^* \beta & |\beta|^2
\end{bmatrix} 
$$
Чистотой состояния называется величина:
$$P = Tr(\rho^2)$$
Для чистого состояния $P = 1$, для смешанного $P < 1$
#### Постулаты квантовой механики
1. Состояние замкнутой квантовой системы описывается матрицей плотности $\rho$.
2. Эволюция системы описывается унитарным преобразованием $U$:  $$\rho \xrightarrow{U} U\rho U^\dagger$$
3. Измерение системы описывается набором $\{M{_m}\}$ операторов измерения, удовлетворяющих условию полноты $\sum_m{M_m^\dagger M_m} = I$ . Вероятность получения результата $m$ равна:$$p(m) = tr(M_m^\dagger M_m \rho)$$ а состояние системы после измерения задается матрицей плотности:
$$p(m) = \frac{M_m \rho M_m^\dagger}{tr(M_m^\dagger M_m \rho)}$$
	**POVM**-измерения описываются набором эрмитовых положительно определенных операторов $E_k = M_k^\dagger M_k$, для которых $\sum_k{E_k} = I$. Вероятность наблюдения исхода $k$ для POVM измерений равна:
	$$
	p(k) = Tr(E_k \rho)
	$$
4. Состояние составной системы ${\rho_1, \rho_2, ..., \rho_n}$ описывается матрицей плотности $\rho_1 \otimes \rho_2 \otimes ... \otimes \rho_n$
## 1.4 Разложение матриц плотности по базису Паули
#### Система из одного кубита
Как уже было сказано ранее, для любой эрмитовой матрицы матрицы $2 \times 2$ c единичным следом существует единственное разложение вида:
$$
\rho = \frac{1}{2}(I + \alpha_1X + \alpha_2Y + \alpha_3 Z), \space \space \alpha_i \in R \space
$$
Для простоты вводим обозначение 
$$
\sigma_0 = I, \space \sigma_1 = X, \space \sigma_2 = Y, \space \sigma_3 = Z
$$
И тогда разложение принимает вид:
$$
\rho = \frac{1}{2}\sum_{i=0}^3\alpha_i \sigma_i
$$
Состояние однокубитной системы представлено (эрмитовой) положительно определенной матрицей $2\times 2$ с единичным следом, следовательно, любую матрицу плотности такой системы можно представить в виде разложения по матрицам Паули.
Однако,  обратное неверно: не любая линейная комбинация матриц Паули будет матрицей плотности: может быть не выполнено условие положительной определенности.
#### Система из N кубит
Любою матрицу плотности $\rho$ системы из $n$ кубит можно записать в виде:
$$
\rho = \frac{1}{2^n}\sum_{i_1, i_2, ..., i_n}{\alpha_{i_1i_2...i_n} (\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n})}
$$
Коэффициенты разложения можно найти как:
$$
\alpha_{i_1i_2...i_n} = \frac{1}{2^n} tr((\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n})^\dagger \rho) = \frac{1}{2^n} tr((\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n}) \rho)
$$
## 1.5 Измерения в терминах квантовой схемы
### Вычислительный базис
Квантовые схемы состоят из унитарных операций и операций измерения кубита в вычислительном базисе $\ket{0}, \ket{1}$.
Измерение кубиты в вычислительном базисе можно описать в терминах POVM-измерений матрицами:
$$E_1 = \ket{0}\bra{0} =  \begin{bmatrix}1 & 0 \\ 0&0 \end{bmatrix},\space
E_2 = \ket{1}\bra{1} =  \begin{bmatrix}0 & 0 \\ 0&1 \end{bmatrix}$$ 
Для состояния: 
$$\rho = \ket{\psi}\bra{\psi} = \begin{bmatrix}\alpha\\\beta\end{bmatrix} \begin{bmatrix}\alpha^*&\beta^*\end{bmatrix} = 
\begin{bmatrix}
|\alpha|^2& \alpha \beta^*\\
\alpha^* \beta & |\beta|^2
\end{bmatrix} $$
исход $0$ наступит с вероятностью $Tr(E_1\rho) = |\alpha|^2$ , а исход $1$ наступит с вероятностью $Tr(E_2\rho) = |\beta|^2$.
### Базис собственных векторов матриц Паули
Достаточно просто свести измерения в базисе из собственных векторов матриц Паули $X,Y,Z$ к измерениям в вычислительном базисе. 
#### Измерение в базисе Z
Так как собственные вектора матрицы $Z$ совпадают с вычислительным базисом $\ket{0}, \ket{1}$, измерение в базисе Z является стандартным измерением в вычислительном базисе. Отличаются только исходы - собственные числа матрицы $Z$, что важно помнить при вычислении наблюдаемой.
#### Измерение в базисе X
Измерение в базисе $X$ описывается POVM операторами:
$$E^X_1 = \ket{+}\bra{+} =  \frac{1}{2}\begin{bmatrix}1 & 1 \\ 1 & 1 \end{bmatrix},\space
E^X_2 = \ket{-}\bra{-} =  \frac{1}{2}\begin{bmatrix}1 & -1 \\ -1 & 1 \end{bmatrix}$$

Их можно выразить через измерения в вычислительном базисе $E_1, E_2$, используя матрицу Адамара:
$$
E^X_1 = H^\dagger E_1H = \frac{1}{\sqrt{2}} \begin{bmatrix}1 & 1 \\ 1 & -1 \end{bmatrix}\begin{bmatrix}1 & 0 \\ 0&0 \end{bmatrix} \frac{1}{\sqrt{2}} \begin{bmatrix}1 & 1 \\ 1 & -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix}1 & 1 \\ 1 & 1 \end{bmatrix}
$$
Вероятность исхода $1$ при измерении $E^X_1$ задается выражением $Tr(E^X_1\rho)$ . В силу
$$Tr(E^X_1\rho) = Tr(H^\dagger E_1H\rho) = Tr(\rho^\dagger H^\dagger E_1^\dagger H)= Tr(\rho H^\dagger E_1 H) = Tr( E_1 H\rho H^\dagger)$$
измерение с проектором $E^X_1$ состояния $\rho$ равносильно измерению в вычислительном базисе состояния $H\rho H^\dagger$. 
Иными словами, чтобы измерить состояние $\rho$ в базисе $X$, необходимо применить к системе преобразование $H$, а затем провести измерение в стандартном вычислительном базисе.
#### Измерение в базисе Y
Измерение в базисе Y производится по той же схеме, в силу:
$$
E^Y_1 = \ket{+i}\bra{+i} = \begin{bmatrix}1 & -i \\ i & 1 \end{bmatrix} = (H S^\dagger) ^\dagger E^Y_1 H S^\dagger
$$
