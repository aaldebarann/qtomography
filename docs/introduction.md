# 1. Введение
## 1.1. Из линейной алгебры
#### Скалярное произведение
***Эрмитово-сопряженная матрица*** - матрица, полученная из исходной транспонированием и заменой каждого элемента на комплексно сопряженный:
$$A^\dagger = \overline{A^T}$$
***Гильбертово пространство*** - полное линейное пространство, в котором задано скалярное произведение. В пространстве квадратных матриц скалярное произведение Гильберта-Шмидта задается как:
$$(A, B) = tr(A^\dagger B)$$
#### Свойства следа:
1. $Tr(AB) = Tr(BA)$
2. $Tr(A\otimes B) = Tr(B\otimes A)$
3. $[Tr(AB)]^{*} = Tr(B^\dagger A^\dagger)$
#### Эрмитова матрица 
***Эрмитова матрица*** - матрица, совпадающая со свомим эрмитовым сопряжением:
$$H^\dagger = H$$
Свойства эрмитовой матрицы:
1. Вещественная эрмитова матрица является симметричной
2. Все собственные значения вещественны, а из собственных векторов можно составить ортонормированную систему
3. Сумма двух эрмитовых матриц - эрмитова
#### Унитарная матрица
Унитарная матрица - матрица, обратная к которой равна ее эрмитову сопряжению:
$$U^{-1} = U^\dagger$$
Свойства унитарной матрицы:
1. $U^\dagger U = U U^\dagger = I$
2. Столбцы матрицы A образуют ортонормированный базис в унитарном пространстве
3. Строки матрицы A образуют ортонормированный базис в унитарном пространстве
4. Сохраняет норму вектора: $||U\psi|| = ||\psi||$
#### Положительная определенность
Положительно (неотрицательно) определенной матрицей называют **эрмитову** матрицу, если все ее собственные значения положительны (неотрицательны).
$$\lambda_i(A) \ge 0$$
## 1.2 Матрицы Паули
***Матрицы Паули*** - набор из трёх **эрмитовых** и одновременно **унитарных** матриц $2\times2$ , составляющих базис в пространстве всех эрмитовых матриц с нулевым следом:
$$
X =
\begin{bmatrix}
0 & 1 \\ 1 & 0
\end{bmatrix}, \space\space
Y =
\begin{bmatrix}
0 & -i \\ i & 0
\end{bmatrix},\space\space
Z =
\begin{bmatrix}
1 & 0 \\ 0 & -1
\end{bmatrix}
$$
Свойства матриц Паули:
1. $\sigma_i^\dagger = \sigma_i = \sigma^{-1}$
2. $Tr(\sigma_i) = 0$
3. $Tr(\sigma_i \sigma_j) = 2\delta_{ij}$ 
4. $||\sigma_i|| = 2$
Собственные значения и собственные векторы матриц Паули:
##### Pauli-X:
$$
\lambda = 1:\space \ket{+} = \frac{1}{\sqrt{2}}(\ket{0} + \ket{1}
$$$$
\lambda = -1:\space \ket{-} = \frac{1}{\sqrt{2}}(\ket{0} - \ket{1}
$$
##### Pauli-Y:
$$
\lambda = 1:\space \ket{+i} = \frac{1}{\sqrt{2}}(\ket{0} + i\ket{1}
$$$$
\lambda = -1:\space \ket{-i} = \frac{1}{\sqrt{2}}(\ket{0} - i\ket{1}
$$
##### Pauli-Z:
$$
\lambda = 1:\space \ket{0}
$$$$
\lambda = -1:\space \ket{1}
$$
#### Разложение в базис
Для любой эрмитовой матрицы $2 \times 2$ c единичным следом существует единственное разложение вида:
$$
\rho = \frac{1}{2}(I + \alpha_1X + \alpha_2Y + \alpha_3 Z) 
$$
где $\alpha_i \in R$.
## 1.3. Матрица плотности
***Матрица плотности*** - (эрмитова) неотрицательно определенная матрица с единичным следом:
1. $\rho \ge 0$
2. $tr(\rho) =1$
Матрица плотности используется, чтобы описывать состояние квантовой системы.
#### Физический смысл
Предположим, что квантовая система находится в одном из состояний набора $\ket{\psi_i}$, причем вероятность нахождения в состоянии $\ket{\psi_i}$ равна $p_i$ . Тогда система описывается матрицей плотности:
$$\rho = \sum_i{ p_i \ket{\psi_i} \bra{\psi_i}}$$
Будем называть $\ket{\psi_i}$ чистыми состояниями (***pure state***), а состояние, описанное выше - смешанным (***mixed state***).
##### Чистота состояния
Матрица плотности чистого состояния $\ket{\psi}$ выглядит как $\rho = \ket{\psi}\bra{\psi}$. Для такого состояния на диагонали матрицы плотности будут записаны квадраты амплитуд состояния - вероятности базисных состояний:
$$
\rho = \ket{\psi}\bra{\psi} = \begin{bmatrix}\alpha\\\beta\end{bmatrix} \begin{bmatrix}\alpha^*&\beta^*\end{bmatrix} = 
\begin{bmatrix}
|\alpha|^2& \alpha \beta^*\\
\alpha^* \beta & |\beta|^2
\end{bmatrix} 
$$
Чистотой состояния называется величина:
$$P = Tr(\rho^2)$$
Для чистого состояния $P = 1$, для смешанного $P < 1$
#### Постулаты квантовой механики
1. Состояние замкнутой квантовой системы описывается матрицей плотности $\rho$.
2. Эволюция системы описывается унитарным преобразованием $U$:  $$\rho \xrightarrow{U} U\rho U^\dagger$$
3. Измерение системы описывается набором $\{M{_m}\}$ операторов измерения, удовлетворяющих условию полноты $\sum_m{M_m^\dagger M_m} = I$ . Вероятность получения результата $m$ равна:$$p(m) = tr(M_m^\dagger M_m \rho)$$ а состояние системы после измерения задается матрицей плотности:
$$p(m) = \frac{M_m \rho M_m^\dagger}{tr(M_m^\dagger M_m \rho)}$$
	**POVM**-измерения описываются набором эрмитовых положительно определенных операторов $E_k = M_k^\dagger M_k$, для которых $\sum_k{E_k} = I$. Вероятность наблюдения исхода $k$ для POVM измерений равна:
	$$
	p(k) = Tr(E_k \rho)
	$$
4. Состояние составной системы ${\rho_1, \rho_2, ..., \rho_n}$ описывается матрицей плотности $\rho_1 \otimes \rho_2 \otimes ... \otimes \rho_n$
## 1.4 Разложение матриц плотности по базису Паули
#### Система из одного кубита
Как уже было сказано ранее, для любой эрмитовой матрицы матрицы $2 \times 2$ c единичным следом существует единственное разложение вида:
$$
\rho = \frac{1}{2}(I + \alpha_1X + \alpha_2Y + \alpha_3 Z), \space \space \alpha_i \in R \space
$$
Для простоты вводим обозначение 
$$
\sigma_0 = I, \space \sigma_1 = X, \space \sigma_2 = Y, \space \sigma_3 = Z
$$
И тогда разложение принимает вид:
$$
\rho = \frac{1}{2}\sum_{i=0}^3\alpha_i \sigma_i
$$
Состояние однокубитной системы представлено (эрмитовой) положительно определенной матрицей $2\times 2$ с единичным следом, следовательно, любую матрицу плотности такой системы можно представить в виде разложения по матрицам Паули.
Однако,  обратное неверно: не любая линейная комбинация матриц Паули будет матрицей плотности: может быть не выполнено условие положительной определенности.
#### Система из N кубит
Любою матрицу плотности $\rho$ системы из $n$ кубит можно записать в виде:
$$
\rho = \frac{1}{2^n}\sum_{i_1, i_2, ..., i_n}{\alpha_{i_1i_2...i_n} (\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n})}
$$
Коэффициенты разложения можно найти как:
$$
\alpha_{i_1i_2...i_n} = \frac{1}{2^n} tr((\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n})^\dagger \rho) = \frac{1}{2^n} tr((\sigma_{i_1} \otimes \sigma_{i_2} \otimes ... \otimes \sigma_{i_n}) \rho)
$$
## 1.5 Измерения в терминах квантовой схемы
### Вычислительный базис
Квантовые схемы состоят из унитарных операций и операций измерения кубита в вычислительном базисе $\ket{0}, \ket{1}$.
Измерение кубиты в вычислительном базисе можно описать в терминах POVM-измерений матрицами:
$$E_1 = \ket{0}\bra{0} =  \begin{bmatrix}1 & 0 \\ 0&0 \end{bmatrix},\space
E_2 = \ket{1}\bra{1} =  \begin{bmatrix}0 & 0 \\ 0&1 \end{bmatrix}$$ 
Для состояния: 
$$\rho = \ket{\psi}\bra{\psi} = \begin{bmatrix}\alpha\\\beta\end{bmatrix} \begin{bmatrix}\alpha^*&\beta^*\end{bmatrix} = 
\begin{bmatrix}
|\alpha|^2& \alpha \beta^*\\
\alpha^* \beta & |\beta|^2
\end{bmatrix} $$
исход $0$ наступит с вероятностью $Tr(E_1\rho) = |\alpha|^2$ , а исход $1$ наступит с вероятностью $Tr(E_2\rho) = |\beta|^2$.
### Базис собственных векторов матриц Паули
Достаточно просто свести измерения в базисе из собственных векторов матриц Паули $X,Y,Z$ к измерениям в вычислительном базисе. 
#### Измерение в базисе Z
Так как собственные вектора матрицы $Z$ совпадают с вычислительным базисом $\ket{0}, \ket{1}$, измерение в базисе Z является стандартным измерением в вычислительном базисе. Отличаются только исходы - собственные числа матрицы $Z$, что важно помнить при вычислении наблюдаемой.
```log
     ┌─┐
  q: ┤M├
     └╥┘
c: 1/═╩═
      0
```
#### Измерение в базисе X
Измерение в базисе $X$ описывается POVM операторами:
$$E^X_1 = \ket{+}\bra{+} =  \frac{1}{2}\begin{bmatrix}1 & 1 \\ 1 & 1 \end{bmatrix},\space
E^X_2 = \ket{-}\bra{-} =  \frac{1}{2}\begin{bmatrix}1 & -1 \\ -1 & 1 \end{bmatrix}$$

Их можно выразить через измерения в вычислительном базисе $E_1, E_2$, используя матрицу Адамара:
$$
E^X_1 = H^\dagger E_1H = \frac{1}{\sqrt{2}} \begin{bmatrix}1 & 1 \\ 1 & -1 \end{bmatrix}\begin{bmatrix}1 & 0 \\ 0&0 \end{bmatrix} \frac{1}{\sqrt{2}} \begin{bmatrix}1 & 1 \\ 1 & -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix}1 & 1 \\ 1 & 1 \end{bmatrix}
$$
Вероятность исхода $1$ при измерении $E^X_1$ задается выражением $Tr(E^X_1\rho)$ . В силу
$$Tr(E^X_1\rho) = Tr(H^\dagger E_1H\rho) = Tr(\rho^\dagger H^\dagger E_1^\dagger H)= Tr(\rho H^\dagger E_1 H) = Tr( E_1 H\rho H^\dagger)$$
измерение с проектором $E^X_1$ состояния $\rho$ равносильно измерению в вычислительном базисе состояния $H\rho H^\dagger$. 
Иными словами, чтобы измерить состояние $\rho$ в базисе $X$, необходимо применить к системе преобразование $H$, а затем провести измерение в стандартном вычислительном базисе.
```log
   ┌───┐┌─┐
q: ┤ H ├┤M├
   └───┘└╥┘
c: 1/════╩═
         0
```
#### Измерение в базисе Y
Измерение в базисе Y производится по той же схеме, в силу:
$$
E^Y_1 = \ket{+i}\bra{+i} = \begin{bmatrix}1 & -i \\ i & 1 \end{bmatrix} = (H S^\dagger) ^\dagger E^Y_1 H S^\dagger
$$
```log
   ┌───┐┌─────┐┌─┐
q: ┤ H ├┤ Sdg ├┤M├
   └───┘└─────┘└╥┘
c: 1/═══════════╩═
                0
```
### Двухкубитный случай

# 2. QST: Классический метод
## 2.1 Краткий протокол метода

Для матрицы плотности размером $d \times d$ (система из $d$ кубит):
1. Выбирается ортонормированный базис $\{B_j\}_{j=1}^{d^2-1}$ в пространстве эрмитовых матриц с нулевым следом. Например, базис Паули.
2. Выбирается набор POVM операторов $\{P_k\}$.
3. Для каждого $P_k$ проводится серия экспериментов с двумя исходами '1' и '0', описываемыми парой $\{P_k, I - P_k\}$.
4. В каждой серии экспериментов вычисляется частота возникновения первого исхода $\hat{f_k} = \frac{n_k}{N_k}$.  
5. Приравнивая частоту к теоретической вероятности, получаем систему линейных уравнений относительно вектора $\theta = (\theta_j)$, $j = 1, ..., d^2-1$:
$$\hat{f} = \frac{1}{d} + X\theta$$Исходная матрица плотности может быть найдена как $\rho = \frac{I}{d} + \sum_{j = 1}^{d^2 - 1}\theta_j B_j$  
Здесь $X$ - матрица, составленная из коэффициентов разложения операторов $\{P_k\}$ по базису $\{B_j\}$.  
#### Замечание
* Метод **не зависит** от выбора базиса $\{B_j\}$. Например, можно использовать ортонормированный базис Паули.  
* Метод **зависит** от выбора операторов измерения $\{P_k\}$. Чтобы частоты $\hat{f_k}$ однозначно задавали $\theta$, необходимо выбрать $d^2$ линейно независимых операторов, однако на практике нет смысла искать точное решение системы. Вопрос выбора операторов измерения - тема для отдельного исследования.
* Задача $\hat{f} = \frac{1}{d} + X\theta$ может быть решена несколькими способами: линейной инверсией (точное решение), МНК, ММП, Баесовский метод. Эти методы будут подробно рассмотрены далее.
* Полученная таким образом матрица $\rho$ может не оказаться положительно определенной - необходимо накладывать дополнительные условия.
## 2.2. Выбор операторов измерения и проведение эксперимента
### Наивный подход
Наивный подход состоит в том, чтобы искать матрицу плотности как точное решение. В таком случае, для системы из $n$ кубит потребуется $2^{2n} - 1$ линейно независимых операторов измерения.
#### Система из одного кубита
Так как мы умеем проводить измерения в базисе матриц Паули, самым простым решением будет взять операторы измерения, порожденные собственными векторами матриц Паули:
$$
P_1 = \ket{0}\bra{0} = \begin{bmatrix}1 & 0 \\ 0 & 0 \end{bmatrix},\space P_2 = \ket{+}\bra{+} = \frac{1}{2}\begin{bmatrix}1 & 1 \\ 1 & 1 \end{bmatrix}, \space P_3 = \ket{+i}\bra{+i} = \begin{bmatrix}1 & -i \\ i & 1 \end{bmatrix}
$$
Нетрудно убедиться, что данные операторы линейно независимы, Тогда для описанного выше метода нужно провести три серии экспериментов с двумя исходами: $\{P_1, I - P_1\}, \{P_2, I - P_2\}, \{P_3, I - P_3\}$.
В каждом из них наступление исхода $P_k$ связано с получением результата `'0'` . Иными словами, необходимо сделать следующее: переходим в базис наблюдаемой и измеряем кубит. Частота значения `'0'` и будет искомым значением $\hat{f}_k$.
#### Система из двух кубит
В системе из двух кубит для нахождения точного решения нам потребуется $15$ линейно независимых операторов. Если вновь взять собственные векторы матриц Паули, мы получим:
1. $P_1 = I \otimes \ket{+}\bra{+}$
2. $P_2 = I \otimes \ket{+i}\bra{+i}$
3. $P_3 = I \otimes \ket{0}\bra{0}$
4. $P_5 = \ket{+}\bra{+} \otimes I$
5. $P_5 = \ket{+i}\bra{+i} \otimes I$
6. $P_6 = \ket{0}\bra{0} \otimes I$
в случае измерения в базисах наблюдаемых $IX, IY, IZ, XI, YI, YZ$. Как и в однокубитном случае, это будут эксперименты с двумя исходами: ${IX, II - IX}, {IY, II- IY}, ...$ Квантовая схема строится так же, как и в первом случае, но преобразования применяется только к одному из кубитов. Например, для $XI$ и $IY$:
```log
XI:
     ┌───┐┌─┐
q_0: ┤ H ├┤M├
     └┬─┬┘└╥┘
q_1: ─┤M├──╫─
      └╥┘  ║ 
c: 2/══╩═══╩═
       1   0
-----------------------
IY:
          ┌─┐          
q_0: ─────┤M├──────────
     ┌───┐└╥┘┌─────┐┌─┐
q_1: ┤ H ├─╫─┤ Sdg ├┤M├
     └───┘ ║ └─────┘└╥┘
c: 2/══════╩═════════╩═
           0         1
```
Еще девять операторов можно получить при измерении в базисах наблюдаемых $XX, YY, ZZ$
$XX$:
7. $P_7 = \ket{+}\bra{+} \otimes \ket{+}\bra{+}$
8. $P_8 = \ket{-}\bra{-} \otimes \ket{-}\bra{-}$
9. $P_9 = \ket{+}\bra{+} \otimes \ket{-}\bra{-}$
$YY$:
10. $P_{10} = \ket{+i}\bra{+i} \otimes \ket{+i}\bra{+i}$
11. $P_{11} = \ket{-i}\bra{-i} \otimes \ket{-i}\bra{-i}$
12. $P_{12} = \ket{+i}\bra{+i} \otimes \ket{-i}\bra{-i}$
$ZZ$:
13. $P_{13} = \ket{0}\bra{0} \otimes \ket{0}\bra{0}$
14. $P_{14} = \ket{1}\bra{1} \otimes \ket{1}\bra{1}$
15. $P_{15} = \ket{0}\bra{0} \otimes \ket{1}\bra{1}$
В отличии от однокубитного случая, измерения в базисах $XX, YY, ZZ$ являются экспериментами с четырьмя исходами. Например, при измерении $ZZ$ исходы будут описываться операторами $P_7,\space P_8,\space P_9,\space I-P_7-P_8-P_9$. Поэтому одна и та же схема будет участвовать в трех сериях экспериментов: для $P_7$, $P_8$ и $P_9$.
При этом, хотя схема одинаковая для всех трех случаев, исходы различаются. Оператору $P_7 = \ket{+}\bra{+} \otimes \ket{+}\bra{+}$ будет соответствовать результат измерения `'00'` (по аналогии с одномерным случаем, когда `'0' соответсвовал оператору `$\ket{+}\bra{+}$ ), оператору $P_8 = \ket{-}\bra{-} \otimes \ket{-}\bra{-}$ случай `'11'`, а оператору $P_9 = \ket{+}\bra{+} \otimes \ket{-}\bra{-}$ - случай `'01'`.
##### На примере измерения в базисе $YY$
###### Схема:
```log
YY:
          ┌─┐          
q_0: ─────┤M├──────────
     ┌───┐└╥┘┌─────┐┌─┐
q_1: ┤ H ├─╫─┤ Sdg ├┤M├
     └───┘ ║ └─────┘└╥┘
c: 2/══════╩═════════╩═
           0         1
```
Частота $f_{10}$ для оператора $P_{10}$: `count('00') / num_shots`
Частота $f_{11}$ для оператора $P_{10}$: `count('11') / num_shots`
Частота $f_{12}$ для оператора $P_{10}$: `count('10') / num_shots`
#### Система из n кубит
Измерения в системе из n кубит проводятся по аналогии с двухкубитным случаем.
#### Замечание:
Так как при проведении некоторых опытов квантовая схема одинакова, число экспериментов можно сократить.
## 2.3 Выбор метода оптимизации
